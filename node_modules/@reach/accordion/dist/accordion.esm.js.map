{"version":3,"file":"accordion.esm.js","sources":["../src/index.tsx"],"sourcesContent":["/**\n * Welcome to @reach/accordion!\n *\n * TODO: Animation examples\n *\n * @see Docs     https://reacttraining.com/reach-ui/accordion\n * @see Source   https://github.com/reach/reach-ui/tree/master/packages/accordion\n * @see WAI-ARIA https://www.w3.org/TR/wai-aria-practices-1.1/#accordion\n */\n\nimport React, {\n  forwardRef,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport {\n  checkStyles,\n  createNamedContext,\n  forwardRefWithAs,\n  isBoolean,\n  isNumber,\n  makeId,\n  noop,\n  useForkedRef,\n  wrapEvent,\n} from \"@reach/utils\";\nimport {\n  createDescendantContext,\n  DescendantProvider,\n  useDescendant,\n  useDescendantKeyDown,\n  useDescendants,\n} from \"@reach/descendants\";\nimport { useId } from \"@reach/auto-id\";\nimport PropTypes from \"prop-types\";\nimport warning from \"warning\";\n\nconst AccordionDescendantContext = createDescendantContext<\n  HTMLElement,\n  DescendantProps\n>(\"AccordionDescendantContext\");\nconst AccordionContext = createNamedContext<IAccordionContext>(\n  \"AccordionContext\",\n  {} as IAccordionContext\n);\nconst AccordionItemContext = createNamedContext<IAccordionItemContext>(\n  \"AccordionItemContext\",\n  {} as IAccordionItemContext\n);\nconst useAccordionContext = () => useContext(AccordionContext);\nconst useAccordionItemContext = () => useContext(AccordionItemContext);\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport enum AccordionStates {\n  Open = \"open\",\n  Collapsed = \"collapsed\",\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Accordion\n *\n * The wrapper component for all other accordion components. Each accordion\n * component will consist of accordion items whose buttons are keyboard\n * navigable using arrow keys.\n *\n * @see Docs https://reacttraining.com/reach-ui/accordion#accordion-1\n */\nexport const Accordion = forwardRef<HTMLDivElement, AccordionProps>(\n  function Accordion(\n    {\n      children,\n      defaultIndex,\n      index: controlledIndex,\n      onChange,\n      readOnly = false,\n      collapsible = false,\n      multiple = false,\n      ...props\n    },\n    forwardedRef\n  ) {\n    /*\n     * You shouldn't switch between controlled/uncontrolled. We'll check for a\n     * controlled component and track any changes in a ref to show a warning.\n     */\n    const wasControlled = typeof controlledIndex !== \"undefined\";\n    const { current: isControlled } = useRef(wasControlled);\n\n    const [descendants, setDescendants] = useDescendants<\n      HTMLElement,\n      DescendantProps\n    >();\n\n    const id = useId(props.id);\n\n    // Define our default starting index\n    const [openPanels, setOpenPanels] = useState<AccordionIndex>(() => {\n      switch (true) {\n        case isControlled:\n          return controlledIndex!;\n\n        // If we have a defaultIndex, we need to do a few checks\n        case defaultIndex != null:\n          /*\n           * If multiple is set to true, we need to make sure the `defaultIndex`\n           * is an array (and vice versa). We'll handle console warnings in\n           * our propTypes, but this will at least keep the component from\n           * blowing up.\n           */\n          if (multiple) {\n            return Array.isArray(defaultIndex) ? defaultIndex : [defaultIndex!];\n          } else {\n            return Array.isArray(defaultIndex)\n              ? defaultIndex[0] ?? 0\n              : defaultIndex!;\n          }\n\n        /*\n         * Collapsible accordions with no defaultIndex will start with all\n         * panels collapsed. Otherwise the first panel will be our default.\n         */\n        case collapsible:\n          return multiple ? [-1] : -1;\n        default:\n          return multiple ? [0] : 0;\n      }\n    });\n\n    if (__DEV__) {\n      warning(\n        !(!isControlled && wasControlled),\n        \"Accordion is changing from controlled to uncontrolled. Accordion should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled Accordion for the lifetime of the component. Check the `index` prop being passed in.\"\n      );\n      warning(\n        !(isControlled && !wasControlled),\n        \"Accordion is changing from uncontrolled to controlled. Accordion should not switch from uncontrolled to controlled (or vice versa). Decide between using a controlled or uncontrolled Accordion for the lifetime of the component. Check the `index` prop being passed in.\"\n      );\n      warning(\n        !(isControlled && collapsible),\n        \"The `collapsible` prop on Accordion has no effect when the state of the component is controlled.\"\n      );\n      warning(\n        !(isControlled && multiple),\n        \"The `multiple` prop on Accordion has no effect when the state of the component is controlled.\"\n      );\n    }\n\n    const onSelectPanel = useCallback(\n      (index: number) => {\n        onChange && onChange(index);\n\n        if (!isControlled) {\n          setOpenPanels(prevOpenPanels => {\n            /*\n             * If we're dealing with an uncontrolled component, the index arg\n             * in selectChange will always be a number rather than an array.\n             */\n            index = index as number;\n            // multiple allowed\n            if (multiple) {\n              // state will always be an array here\n              prevOpenPanels = prevOpenPanels as number[];\n              if (\n                // User is clicking on an already-open button\n                prevOpenPanels.includes(index as number)\n              ) {\n                // Other panels are open OR accordion is allowed to collapse\n                if (prevOpenPanels.length > 1 || collapsible) {\n                  // Close the panel by filtering it from the array\n                  return prevOpenPanels.filter(i => i !== index);\n                }\n              } else {\n                // Open the panel by adding it to the array.\n                return [...prevOpenPanels, index].sort();\n              }\n            } else {\n              prevOpenPanels = prevOpenPanels as number;\n              return prevOpenPanels === index && collapsible ? -1 : index;\n            }\n            return prevOpenPanels;\n          });\n        }\n      },\n      [collapsible, isControlled, multiple, onChange]\n    );\n\n    const context: IAccordionContext = useMemo(\n      () => ({\n        accordionId: id,\n        openPanels: isControlled ? controlledIndex! : openPanels,\n        onSelectPanel: readOnly ? noop : onSelectPanel,\n        readOnly,\n      }),\n      [openPanels, controlledIndex, id, isControlled, onSelectPanel, readOnly]\n    );\n\n    useEffect(() => checkStyles(\"accordion\"), []);\n\n    return (\n      <DescendantProvider\n        context={AccordionDescendantContext}\n        items={descendants}\n        set={setDescendants}\n      >\n        <AccordionContext.Provider value={context}>\n          <div {...props} ref={forwardedRef} data-reach-accordion=\"\">\n            {children}\n          </div>\n        </AccordionContext.Provider>\n      </DescendantProvider>\n    );\n  }\n);\n\n/**\n * @see Docs https://reacttraining.com/reach-ui/accordion#accordion-props\n */\nexport type AccordionProps = Omit<\n  React.HTMLProps<HTMLDivElement>,\n  \"onChange\"\n> & {\n  /**\n   * `Accordion` can accept `AccordionItem` components as children.\n   *\n   * @see Docs https://reacttraining.com/reach-ui/accordion#accordion-children\n   */\n  children: React.ReactNode;\n  /**\n   * Whether or not all panels of an uncontrolled accordion can be toggled\n   * to a closed state. By default, an uncontrolled accordion will have an open\n   * panel at all times, meaning a panel can only be closed if the user opens\n   * another panel. This prop allows the user to collapse all open panels.\n   *\n   * It's important to note that this prop has no impact on controlled\n   * components, since the state of any given accordion panel is managed solely\n   * by the index prop.\n   */\n  collapsible?: boolean;\n  /**\n   * A default value for the open panel's index or indices in an uncontrolled\n   * accordion component when it is initially rendered.\n   *\n   * @see Docs https://reacttraining.com/reach-ui/accordion#accordion-defaultindex\n   */\n  defaultIndex?: AccordionIndex;\n  /**\n   * The index or array of indices for open accordion panels. The `index` props\n   * should be used along with `onChange` to create controlled accordion\n   * components.\n   *\n   * @see Docs https://reacttraining.com/reach-ui/accordion#accordion-index\n   */\n  index?: AccordionIndex;\n  /**\n   * The callback that is fired when an accordion item's open state is changed.\n   *\n   * @see Docs https://reacttraining.com/reach-ui/accordion#accordion-onchange\n   */\n  onChange?(index?: number): void;\n  /**\n   * Whether or not an uncontrolled accordion is read-only or controllable by a\n   * user interaction.\n   *\n   * Generally speaking you probably want to avoid this, as\n   * it can be confusing especially when navigating by keyboard. However, this\n   * may be useful if you want to lock an accordion under certain conditions\n   * (perhaps user authentication is required to access the content). In these\n   * instances, you may want to include an alert when a user tries to activate\n   * a read-only accordion panel to let them know why it does not toggle as may\n   * be expected.\n   *\n   * TODO: Create example with @reach/alert.\n   *\n   * @see Docs https://reacttraining.com/reach-ui/accordion#accordion-onchange\n   */\n  readOnly?: boolean;\n  /**\n   * Whether or not multiple panels in an uncontrolled accordion can be opened\n   * at the same time. By default, when a user opens a new panel, the previously\n   * opened panel will close. This prop prevents that behavior.\n   *\n   * It's important to note that this prop has no impact on controlled\n   * components, since the state of any given accordion panel is managed solely\n   * by the index prop.\n   */\n  multiple?: boolean;\n};\n\nif (__DEV__) {\n  Accordion.displayName = \"Accordion\";\n  Accordion.propTypes = {\n    children: PropTypes.node.isRequired,\n    defaultIndex: PropTypes.oneOfType([\n      PropTypes.number,\n      PropTypes.arrayOf(PropTypes.number),\n    ]) as any,\n    index: (props, name, compName, location, propName) => {\n      let val = props[name];\n      if (props[name] != null && props.onChange == null && !props.readOnly) {\n        return new Error(\n          \"You provided an `index` prop to `Accordion` without an `onChange` handler. This will render a read-only accordion element. If the accordion should be functional, remove the `index` value to render an uncontrolled accordion or set an `onChange` handler to set an index when a change occurs. If the accordion is intended to have a fixed state, use the `readOnly` prop with a `defaultIndex` instead of an `index`.\"\n        );\n      }\n      if (props[name] != null && props.defaultIndex != null) {\n        return new Error(\n          \"You provided an `index` prop as well as a `defaultIndex` prop to `Accordion`. If you want a controlled component, use the index prop with an onChange handler. If you want an uncontrolled component, remove the index prop and use `defaultIndex` instead.\"\n        );\n      }\n      if (Array.isArray(props[name])) {\n        return props[name].some((i: any) => !isNumber(i))\n          ? new Error(\n              \"You provided an array as an index in `Accordion` but one or more of the values are not numeric. Please check to make sure all indices are valid numbers.\"\n            )\n          : null;\n      } else if (props[name] != null && !isNumber(props[name])) {\n        return new Error(\n          `Invalid prop \"${propName}\" supplied to \"${compName}\". Expected \"number\", received \"${\n            Array.isArray(val) ? \"array\" : typeof val\n          }\".`\n        );\n      }\n      return null;\n    },\n    multiple: (props, name, compName, location, propName) => {\n      if (!props[name] && Array.isArray(props.defaultIndex)) {\n        return new Error(\n          `The \"${propName}\" prop supplied to \"${compName}\" is not set or set to \"false\", but an array of indices was provided to the \"defaultIndex\" prop. \"${compName}\" can only have more than one default index if the \"${propName}\" prop is set to \"true\".`\n        );\n      } else if (props[name] != null && !isBoolean(props[name])) {\n        return new Error(\n          `Invalid prop \"${propName}\" supplied to \"${compName}\". Expected \"boolean\", received \"${\n            Array.isArray(props[name]) ? \"array\" : typeof props[name]\n          }\".`\n        );\n      }\n      return null;\n    },\n    onChange: PropTypes.func,\n    readOnly: PropTypes.bool,\n    collapsible: PropTypes.bool,\n  };\n}\n\n/**\n * AccordionItem\n *\n * A group that wraps a an accordion's button and panel components.\n *\n * @see Docs https://reacttraining.com/reach-ui/accordion#accordionitem\n */\nexport const AccordionItem = forwardRefWithAs<AccordionItemProps, \"div\">(\n  function AccordionItem(\n    { as: Comp = \"div\", children, disabled = false, ...props },\n    forwardedRef\n  ) {\n    const { accordionId, openPanels, readOnly } = useAccordionContext();\n    const buttonRef: ButtonRef = useRef(null);\n\n    const index = useDescendant({\n      context: AccordionDescendantContext,\n      element: buttonRef.current,\n      disabled,\n    });\n\n    // We need unique IDs for the panel and button to point to one another\n    const itemId = makeId(accordionId, index);\n    const panelId = makeId(\"panel\", itemId);\n    const buttonId = makeId(\"button\", itemId);\n\n    const open = Array.isArray(openPanels)\n      ? openPanels.includes(index)\n      : openPanels === index;\n\n    const dataAttributes = {\n      \"data-state\": open ? AccordionStates.Open : AccordionStates.Collapsed,\n      \"data-disabled\": disabled ? \"true\" : undefined,\n      \"data-read-only\": readOnly ? \"true\" : undefined,\n    };\n\n    const context: IAccordionItemContext = {\n      open,\n      disabled,\n      buttonId,\n      index,\n      itemId,\n      buttonRef,\n      panelId,\n      dataAttributes,\n    };\n\n    return (\n      <AccordionItemContext.Provider value={context}>\n        <Comp\n          {...props}\n          ref={forwardedRef}\n          data-reach-accordion-item=\"\"\n          {...dataAttributes}\n        >\n          {children}\n        </Comp>\n      </AccordionItemContext.Provider>\n    );\n  }\n);\n\n/**\n * @see Docs https://reacttraining.com/reach-ui/accordion#accordionitem-props\n */\nexport type AccordionItemProps = {\n  /**\n   * An `AccordionItem` expects to receive an `AccordionButton` and\n   * `AccordionPanel` components as its children, though you can also nest other\n   * components within an `AccordionItem` if you want some persistant content\n   * that is relevant to the section but not collapsible when the\n   * `AccordionButton` is toggled.\n   *\n   * @see Docs https://reacttraining.com/reach-ui/accordion#accordionitem-children\n   */\n  children: React.ReactNode;\n  /**\n   * Whether or not an accordion panel is disabled from user interaction.\n   *\n   * @see Docs https://reacttraining.com/reach-ui/accordion#accordionitem-disabled\n   */\n  disabled?: boolean;\n};\n\nif (__DEV__) {\n  AccordionItem.displayName = \"AccordionItem\";\n  AccordionItem.propTypes = {\n    disabled: PropTypes.bool,\n  };\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * AccordionButton\n *\n * The trigger button a user clicks to interact with an accordion.\n *\n * Must be a direct child of a `AccordionItem`.\n *\n * @see Docs https://reacttraining.com/reach-ui/accordion#accordionbutton\n */\nexport const AccordionButton = forwardRefWithAs<AccordionButtonProps, \"button\">(\n  function AccordionButton(\n    {\n      as: Comp = \"button\",\n      children,\n      onClick,\n      onKeyDown,\n      onMouseDown,\n      onPointerDown,\n      tabIndex,\n      ...props\n    },\n    forwardedRef\n  ) {\n    let { onSelectPanel } = useAccordionContext();\n\n    let {\n      open,\n      dataAttributes,\n      disabled,\n      buttonId,\n      buttonRef: ownRef,\n      index,\n      panelId,\n    } = useAccordionItemContext();\n\n    let ref = useForkedRef(forwardedRef, ownRef);\n\n    function handleClick(event: React.MouseEvent) {\n      event.preventDefault();\n      if (disabled) {\n        return;\n      }\n      ownRef.current.focus();\n      onSelectPanel(index);\n    }\n\n    let handleKeyDown = useDescendantKeyDown(AccordionDescendantContext, {\n      currentIndex: index,\n      orientation: \"vertical\",\n      key: \"element\",\n      rotate: true,\n      callback(element: HTMLElement) {\n        element && element.focus();\n      },\n      filter: button => !button.disabled,\n    });\n\n    return (\n      <Comp\n        aria-controls={panelId}\n        aria-expanded={open}\n        {...props}\n        ref={ref}\n        data-reach-accordion-button=\"\"\n        {...dataAttributes}\n        disabled={disabled || undefined}\n        id={buttonId}\n        onClick={wrapEvent(onClick, handleClick)}\n        onKeyDown={wrapEvent(onKeyDown, handleKeyDown)}\n        tabIndex={disabled ? -1 : tabIndex}\n      >\n        {children}\n      </Comp>\n    );\n  }\n);\n\n/**\n * @see Docs https://reacttraining.com/reach-ui/accordion#accordionbutton-props\n */\nexport type AccordionButtonProps = {\n  /**\n   * Typically a text string that serves as a label for the accordion, though\n   * nested DOM nodes can be passed as well so long as they are valid children\n   * of interactive elements.\n   *\n   * @see https://github.com/w3c/html-aria/issues/54\n   * @see Docs https://reacttraining.com/reach-ui/accordion#accordionbutton-children\n   */\n  children: React.ReactNode;\n};\n\nif (__DEV__) {\n  AccordionButton.displayName = \"AccordionButton\";\n  AccordionButton.propTypes = {\n    as: PropTypes.any,\n    children: PropTypes.node,\n  };\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * AccordionPanel\n *\n * The collapsible panel in which inner content for an accordion item is\n * rendered.\n *\n * @see Docs https://reacttraining.com/reach-ui/accordion#accordionpanel\n */\nexport const AccordionPanel = forwardRefWithAs<AccordionPanelProps, \"div\">(\n  function AccordionPanel(\n    { as: Comp = \"div\", children, ...props },\n    forwardedRef\n  ) {\n    const {\n      dataAttributes,\n      panelId,\n      buttonId,\n      open,\n    } = useAccordionItemContext();\n\n    return (\n      <Comp\n        hidden={!open}\n        role=\"region\"\n        aria-labelledby={buttonId}\n        {...props}\n        ref={forwardedRef}\n        data-reach-accordion-panel=\"\"\n        {...dataAttributes}\n        id={panelId}\n        tabIndex={-1}\n      >\n        {children}\n      </Comp>\n    );\n  }\n);\n\n/**\n * @see Docs https://reacttraining.com/reach-ui/accordion#accordionpanel-props\n */\nexport type AccordionPanelProps = {\n  /**\n   * Inner collapsible content for the accordion item.\n   *\n   * @see Docs https://reacttraining.com/reach-ui/accordion#accordionpanel-children\n   */\n  children: React.ReactNode;\n};\n\nif (__DEV__) {\n  AccordionPanel.displayName = \"AccordionPanel\";\n  AccordionPanel.propTypes = {\n    children: PropTypes.node,\n  };\n}\n\n////////////////////////////////////////////////////////////////////////////////\n// Types\n\ntype DescendantProps = {\n  disabled: boolean;\n};\n\ntype ResultBox<T> = { v: T };\n\ntype ButtonRef = React.MutableRefObject<any>;\n\ntype AccordionIndex = number | number[];\n\ninterface IAccordionContext {\n  accordionId: string | undefined;\n  openPanels: AccordionIndex;\n  onSelectPanel(index: AccordionIndex): void;\n  readOnly: boolean;\n}\n\ninterface IAccordionItemContext {\n  open: boolean;\n  disabled: boolean;\n  buttonId: string;\n  index: number;\n  itemId: string;\n  buttonRef: ButtonRef;\n  panelId: string;\n  dataAttributes: {\n    \"data-state\": AccordionStates;\n    \"data-disabled\": string | undefined;\n    \"data-read-only\": string | undefined;\n  };\n}\n"],"names":["AccordionDescendantContext","createDescendantContext","AccordionContext","createNamedContext","AccordionItemContext","useAccordionContext","useContext","useAccordionItemContext","AccordionStates","Accordion","forwardRef","forwardedRef","children","defaultIndex","controlledIndex","index","onChange","readOnly","collapsible","multiple","props","wasControlled","useRef","isControlled","current","useDescendants","descendants","setDescendants","id","useId","useState","Array","isArray","openPanels","setOpenPanels","warning","onSelectPanel","useCallback","prevOpenPanels","includes","length","filter","i","sort","context","useMemo","accordionId","noop","useEffect","checkStyles","React","DescendantProvider","items","set","Provider","value","ref","displayName","propTypes","PropTypes","node","isRequired","oneOfType","number","arrayOf","name","compName","location","propName","val","Error","some","isNumber","isBoolean","func","bool","AccordionItem","forwardRefWithAs","as","Comp","disabled","buttonRef","useDescendant","element","itemId","makeId","panelId","buttonId","open","dataAttributes","Open","Collapsed","undefined","AccordionButton","onClick","onKeyDown","tabIndex","ownRef","useForkedRef","handleClick","event","preventDefault","focus","handleKeyDown","useDescendantKeyDown","currentIndex","orientation","key","rotate","callback","button","wrapEvent","any","AccordionPanel","hidden","role"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAyCA,IAAMA,0BAA0B,gBAAGC,uBAAuB,CAGxD,4BAHwD,CAA1D;AAIA,IAAMC,gBAAgB,gBAAGC,kBAAkB,CACzC,kBADyC,EAEzC,EAFyC,CAA3C;AAIA,IAAMC,oBAAoB,gBAAGD,kBAAkB,CAC7C,sBAD6C,EAE7C,EAF6C,CAA/C;;AAIA,IAAME,mBAAmB,GAAG,SAAtBA,mBAAsB;AAAA,SAAMC,UAAU,CAACJ,gBAAD,CAAhB;AAAA,CAA5B;;AACA,IAAMK,uBAAuB,GAAG,SAA1BA,uBAA0B;AAAA,SAAMD,UAAU,CAACF,oBAAD,CAAhB;AAAA,CAAhC;;;IAIYI;;AAAZ,WAAYA;AACVA,EAAAA,uBAAA,SAAA;AACAA,EAAAA,4BAAA,cAAA;AACD,CAHD,EAAYA,eAAe,KAAfA,eAAe,KAAA,CAA3B;;AAOA;;;;;;;;;;;IASaC,SAAS,gBAAGC,UAAU,CACjC,SAASD,SAAT,OAWEE,YAXF;MAEIC,gBAAAA;MACAC,oBAAAA;MACOC,uBAAPC;MACAC,gBAAAA;2BACAC;MAAAA,sCAAW;8BACXC;MAAAA,4CAAc;2BACdC;MAAAA,sCAAW;MACRC;;AAIL;;;;AAIA,MAAMC,aAAa,GAAG,OAAOP,eAAP,KAA2B,WAAjD;;gBACkCQ,MAAM,CAACD,aAAD;MAAvBE,uBAATC;;wBAE8BC,cAAc;MAA7CC;MAAaC;;AAKpB,MAAMC,EAAE,GAAGC,KAAK,CAACT,KAAK,CAACQ,EAAP,CAAhB;;kBAGoCE,QAAQ,CAAiB;AAC3D,YAAQ,IAAR;AACE,WAAKP,YAAL;AACE,eAAOT,eAAP;AAEF;;AACA,WAAKD,YAAY,IAAI,IAArB;AACE;;;;;;AAMA,YAAIM,QAAJ,EAAc;AACZ,iBAAOY,KAAK,CAACC,OAAN,CAAcnB,YAAd,IAA8BA,YAA9B,GAA6C,CAACA,YAAD,CAApD;AACD,SAFD,MAEO;AAAA;;AACL,iBAAOkB,KAAK,CAACC,OAAN,CAAcnB,YAAd,sBACHA,YAAY,CAAC,CAAD,CADT,2DACgB,CADhB,GAEHA,YAFJ;AAGD;;AAEH;;;;;AAIA,WAAKK,WAAL;AACE,eAAOC,QAAQ,GAAG,CAAC,CAAC,CAAF,CAAH,GAAU,CAAC,CAA1B;;AACF;AACE,eAAOA,QAAQ,GAAG,CAAC,CAAD,CAAH,GAAS,CAAxB;AA3BJ;AA6BD,GA9B2C;MAArCc;MAAYC;;AAgCnB,6CAAa;AACX,4CAAAC,OAAO,CACL,EAAE,CAACZ,YAAD,IAAiBF,aAAnB,CADK,EAEL,4QAFK,CAAP;AAIA,4CAAAc,OAAO,CACL,EAAEZ,YAAY,IAAI,CAACF,aAAnB,CADK,EAEL,4QAFK,CAAP;AAIA,4CAAAc,OAAO,CACL,EAAEZ,YAAY,IAAIL,WAAlB,CADK,EAEL,kGAFK,CAAP;AAIA,4CAAAiB,OAAO,CACL,EAAEZ,YAAY,IAAIJ,QAAlB,CADK,EAEL,+FAFK,CAAP;AAID;;AAED,MAAMiB,aAAa,GAAGC,WAAW,CAC/B,UAACtB,KAAD;AACEC,IAAAA,QAAQ,IAAIA,QAAQ,CAACD,KAAD,CAApB;;AAEA,QAAI,CAACQ,YAAL,EAAmB;AACjBW,MAAAA,aAAa,CAAC,UAAAI,cAAc;AAC1B;;;;AAIAvB,QAAAA,KAAK,GAAGA,KAAR;;AAEA,YAAII,QAAJ,EAAc;AACZ;AACAmB,UAAAA,cAAc,GAAGA,cAAjB;;AACA;AAEEA,UAAAA,cAAc,CAACC,QAAf,CAAwBxB,KAAxB,CAFF,EAGE;AACA;AACA,gBAAIuB,cAAc,CAACE,MAAf,GAAwB,CAAxB,IAA6BtB,WAAjC,EAA8C;AAC5C;AACA,qBAAOoB,cAAc,CAACG,MAAf,CAAsB,UAAAC,CAAC;AAAA,uBAAIA,CAAC,KAAK3B,KAAV;AAAA,eAAvB,CAAP;AACD;AACF,WATD,MASO;AACL;AACA,mBAAO,UAAIuB,cAAJ,GAAoBvB,KAApB,GAA2B4B,IAA3B,EAAP;AACD;AACF,SAhBD,MAgBO;AACLL,UAAAA,cAAc,GAAGA,cAAjB;AACA,iBAAOA,cAAc,KAAKvB,KAAnB,IAA4BG,WAA5B,GAA0C,CAAC,CAA3C,GAA+CH,KAAtD;AACD;;AACD,eAAOuB,cAAP;AACD,OA5BY,CAAb;AA6BD;AACF,GAnC8B,EAoC/B,CAACpB,WAAD,EAAcK,YAAd,EAA4BJ,QAA5B,EAAsCH,QAAtC,CApC+B,CAAjC;AAuCA,MAAM4B,OAAO,GAAsBC,OAAO,CACxC;AAAA,WAAO;AACLC,MAAAA,WAAW,EAAElB,EADR;AAELK,MAAAA,UAAU,EAAEV,YAAY,GAAGT,eAAH,GAAsBmB,UAFzC;AAGLG,MAAAA,aAAa,EAAEnB,QAAQ,GAAG8B,IAAH,GAAUX,aAH5B;AAILnB,MAAAA,QAAQ,EAARA;AAJK,KAAP;AAAA,GADwC,EAOxC,CAACgB,UAAD,EAAanB,eAAb,EAA8Bc,EAA9B,EAAkCL,YAAlC,EAAgDa,aAAhD,EAA+DnB,QAA/D,CAPwC,CAA1C;AAUA+B,EAAAA,SAAS,CAAC;AAAA,WAAMC,WAAW,CAAC,WAAD,CAAjB;AAAA,GAAD,EAAiC,EAAjC,CAAT;AAEA,SACEC,mBAAA,CAACC,kBAAD;AACEP,IAAAA,OAAO,EAAE5C;AACToD,IAAAA,KAAK,EAAE1B;AACP2B,IAAAA,GAAG,EAAE1B;GAHP,EAKEuB,mBAAA,CAAChD,gBAAgB,CAACoD,QAAlB;AAA2BC,IAAAA,KAAK,EAAEX;GAAlC,EACEM,mBAAA,MAAA,oBAAS9B;AAAOoC,IAAAA,GAAG,EAAE7C;4BAAmC;IAAxD,EACGC,QADH,CADF,CALF,CADF;AAaD,CAhJgC;;AA6NnC,2CAAa;AACXH,EAAAA,SAAS,CAACgD,WAAV,GAAwB,WAAxB;AACAhD,EAAAA,SAAS,CAACiD,SAAV,GAAsB;AACpB9C,IAAAA,QAAQ,EAAE+C,SAAS,CAACC,IAAV,CAAeC,UADL;AAEpBhD,IAAAA,YAAY,eAAE8C,SAAS,CAACG,SAAV,CAAoB,CAChCH,SAAS,CAACI,MADsB,eAEhCJ,SAAS,CAACK,OAAV,CAAkBL,SAAS,CAACI,MAA5B,CAFgC,CAApB,CAFM;AAMpBhD,IAAAA,KAAK,EAAE,eAACK,KAAD,EAAQ6C,IAAR,EAAcC,QAAd,EAAwBC,QAAxB,EAAkCC,QAAlC;AACL,UAAIC,GAAG,GAAGjD,KAAK,CAAC6C,IAAD,CAAf;;AACA,UAAI7C,KAAK,CAAC6C,IAAD,CAAL,IAAe,IAAf,IAAuB7C,KAAK,CAACJ,QAAN,IAAkB,IAAzC,IAAiD,CAACI,KAAK,CAACH,QAA5D,EAAsE;AACpE,eAAO,IAAIqD,KAAJ,CACL,4ZADK,CAAP;AAGD;;AACD,UAAIlD,KAAK,CAAC6C,IAAD,CAAL,IAAe,IAAf,IAAuB7C,KAAK,CAACP,YAAN,IAAsB,IAAjD,EAAuD;AACrD,eAAO,IAAIyD,KAAJ,CACL,6PADK,CAAP;AAGD;;AACD,UAAIvC,KAAK,CAACC,OAAN,CAAcZ,KAAK,CAAC6C,IAAD,CAAnB,CAAJ,EAAgC;AAC9B,eAAO7C,KAAK,CAAC6C,IAAD,CAAL,CAAYM,IAAZ,CAAiB,UAAC7B,CAAD;AAAA,iBAAY,CAAC8B,QAAQ,CAAC9B,CAAD,CAArB;AAAA,SAAjB,IACH,IAAI4B,KAAJ,CACE,0JADF,CADG,GAIH,IAJJ;AAKD,OAND,MAMO,IAAIlD,KAAK,CAAC6C,IAAD,CAAL,IAAe,IAAf,IAAuB,CAACO,QAAQ,CAACpD,KAAK,CAAC6C,IAAD,CAAN,CAApC,EAAmD;AACxD,eAAO,IAAIK,KAAJ,qBACYF,QADZ,yBACsCF,QADtC,6CAEHnC,KAAK,CAACC,OAAN,CAAcqC,GAAd,IAAqB,OAArB,GAA+B,OAAOA,GAFnC,UAAP;AAKD;;AACD,aAAO,IAAP;AACD,KAhCmB;AAiCpBlD,IAAAA,QAAQ,EAAE,kBAACC,KAAD,EAAQ6C,IAAR,EAAcC,QAAd,EAAwBC,QAAxB,EAAkCC,QAAlC;AACR,UAAI,CAAChD,KAAK,CAAC6C,IAAD,CAAN,IAAgBlC,KAAK,CAACC,OAAN,CAAcZ,KAAK,CAACP,YAApB,CAApB,EAAuD;AACrD,eAAO,IAAIyD,KAAJ,YACGF,QADH,8BACkCF,QADlC,gHAC+IA,QAD/I,8DAC8ME,QAD9M,iCAAP;AAGD,OAJD,MAIO,IAAIhD,KAAK,CAAC6C,IAAD,CAAL,IAAe,IAAf,IAAuB,CAACQ,SAAS,CAACrD,KAAK,CAAC6C,IAAD,CAAN,CAArC,EAAoD;AACzD,eAAO,IAAIK,KAAJ,qBACYF,QADZ,yBACsCF,QADtC,8CAEHnC,KAAK,CAACC,OAAN,CAAcZ,KAAK,CAAC6C,IAAD,CAAnB,IAA6B,OAA7B,GAAuC,OAAO7C,KAAK,CAAC6C,IAAD,CAFhD,UAAP;AAKD;;AACD,aAAO,IAAP;AACD,KA9CmB;AA+CpBjD,IAAAA,QAAQ,EAAE2C,SAAS,CAACe,IA/CA;AAgDpBzD,IAAAA,QAAQ,EAAE0C,SAAS,CAACgB,IAhDA;AAiDpBzD,IAAAA,WAAW,EAAEyC,SAAS,CAACgB;AAjDH,GAAtB;AAmDD;AAED;;;;;;;;;IAOaC,aAAa,gBAAGC,gBAAgB,CAC3C,SAASD,aAAT,QAEEjE,YAFF;uBACImE;MAAIC,6BAAO;MAAOnE,iBAAAA;6BAAUoE;MAAAA,uCAAW;MAAU5D;;6BAGLf,mBAAmB;MAAzDyC,mCAAAA;MAAab,kCAAAA;MAAYhB,gCAAAA;;AACjC,MAAMgE,SAAS,GAAc3D,MAAM,CAAC,IAAD,CAAnC;AAEA,MAAMP,KAAK,GAAGmE,aAAa,CAAC;AAC1BtC,IAAAA,OAAO,EAAE5C,0BADiB;AAE1BmF,IAAAA,OAAO,EAAEF,SAAS,CAACzD,OAFO;AAG1BwD,IAAAA,QAAQ,EAARA;AAH0B,GAAD,CAA3B;;AAOA,MAAMI,MAAM,GAAGC,MAAM,CAACvC,WAAD,EAAc/B,KAAd,CAArB;AACA,MAAMuE,OAAO,GAAGD,MAAM,CAAC,OAAD,EAAUD,MAAV,CAAtB;AACA,MAAMG,QAAQ,GAAGF,MAAM,CAAC,QAAD,EAAWD,MAAX,CAAvB;AAEA,MAAMI,IAAI,GAAGzD,KAAK,CAACC,OAAN,CAAcC,UAAd,IACTA,UAAU,CAACM,QAAX,CAAoBxB,KAApB,CADS,GAETkB,UAAU,KAAKlB,KAFnB;AAIA,MAAM0E,cAAc,GAAG;AACrB,kBAAcD,IAAI,GAAGhF,eAAe,CAACkF,IAAnB,GAA0BlF,eAAe,CAACmF,SADvC;AAErB,qBAAiBX,QAAQ,GAAG,MAAH,GAAYY,SAFhB;AAGrB,sBAAkB3E,QAAQ,GAAG,MAAH,GAAY2E;AAHjB,GAAvB;AAMA,MAAMhD,OAAO,GAA0B;AACrC4C,IAAAA,IAAI,EAAJA,IADqC;AAErCR,IAAAA,QAAQ,EAARA,QAFqC;AAGrCO,IAAAA,QAAQ,EAARA,QAHqC;AAIrCxE,IAAAA,KAAK,EAALA,KAJqC;AAKrCqE,IAAAA,MAAM,EAANA,MALqC;AAMrCH,IAAAA,SAAS,EAATA,SANqC;AAOrCK,IAAAA,OAAO,EAAPA,OAPqC;AAQrCG,IAAAA,cAAc,EAAdA;AARqC,GAAvC;AAWA,SACEvC,mBAAA,CAAC9C,oBAAoB,CAACkD,QAAtB;AAA+BC,IAAAA,KAAK,EAAEX;GAAtC,EACEM,mBAAA,CAAC6B,IAAD,oBACM3D;AACJoC,IAAAA,GAAG,EAAE7C;iCACqB;KACtB8E,eAJN,EAMG7E,QANH,CADF,CADF;AAYD,CApD0C;;AA6E7C,2CAAa;AACXgE,EAAAA,aAAa,CAACnB,WAAd,GAA4B,eAA5B;AACAmB,EAAAA,aAAa,CAAClB,SAAd,GAA0B;AACxBsB,IAAAA,QAAQ,EAAErB,SAAS,CAACgB;AADI,GAA1B;AAGD;;AAID;;;;;;;;;;;IASakB,eAAe,gBAAGhB,gBAAgB,CAC7C,SAASgB,eAAT,QAWElF,YAXF;uBAEImE;MAAIC,6BAAO;MACXnE,iBAAAA;MACAkF,gBAAAA;MACAC,kBAAAA;MAGAC,iBAAAA;MACG5E;;8BAImBf,mBAAmB;MAArC+B,sCAAAA;;8BAUF7B,uBAAuB;MAPzBiF,6BAAAA;MACAC,uCAAAA;MACAT,iCAAAA;MACAO,iCAAAA;MACWU,+BAAXhB;MACAlE,8BAAAA;MACAuE,gCAAAA;;AAGF,MAAI9B,GAAG,GAAG0C,YAAY,CAACvF,YAAD,EAAesF,MAAf,CAAtB;;AAEA,WAASE,WAAT,CAAqBC,KAArB;AACEA,IAAAA,KAAK,CAACC,cAAN;;AACA,QAAIrB,QAAJ,EAAc;AACZ;AACD;;AACDiB,IAAAA,MAAM,CAACzE,OAAP,CAAe8E,KAAf;AACAlE,IAAAA,aAAa,CAACrB,KAAD,CAAb;AACD;;AAED,MAAIwF,aAAa,GAAGC,oBAAoB,CAACxG,0BAAD,EAA6B;AACnEyG,IAAAA,YAAY,EAAE1F,KADqD;AAEnE2F,IAAAA,WAAW,EAAE,UAFsD;AAGnEC,IAAAA,GAAG,EAAE,SAH8D;AAInEC,IAAAA,MAAM,EAAE,IAJ2D;AAKnEC,IAAAA,QALmE,oBAK1D1B,OAL0D;AAMjEA,MAAAA,OAAO,IAAIA,OAAO,CAACmB,KAAR,EAAX;AACD,KAPkE;AAQnE7D,IAAAA,MAAM,EAAE,gBAAAqE,MAAM;AAAA,aAAI,CAACA,MAAM,CAAC9B,QAAZ;AAAA;AARqD,GAA7B,CAAxC;AAWA,SACE9B,mBAAA,CAAC6B,IAAD;qBACiBO;qBACAE;KACXpE;AACJoC,IAAAA,GAAG,EAAEA;mCACuB;KACxBiC;AACJT,IAAAA,QAAQ,EAAEA,QAAQ,IAAIY;AACtBhE,IAAAA,EAAE,EAAE2D;AACJO,IAAAA,OAAO,EAAEiB,SAAS,CAACjB,OAAD,EAAUK,WAAV;AAClBJ,IAAAA,SAAS,EAAEgB,SAAS,CAAChB,SAAD,EAAYQ,aAAZ;AACpBP,IAAAA,QAAQ,EAAEhB,QAAQ,GAAG,CAAC,CAAJ,GAAQgB;IAX5B,EAaGpF,QAbH,CADF;AAiBD,CAjE4C;;AAmF/C,2CAAa;AACXiF,EAAAA,eAAe,CAACpC,WAAhB,GAA8B,iBAA9B;AACAoC,EAAAA,eAAe,CAACnC,SAAhB,GAA4B;AAC1BoB,IAAAA,EAAE,EAAEnB,SAAS,CAACqD,GADY;AAE1BpG,IAAAA,QAAQ,EAAE+C,SAAS,CAACC;AAFM,GAA5B;AAID;;AAID;;;;;;;;;;IAQaqD,cAAc,gBAAGpC,gBAAgB,CAC5C,SAASoC,cAAT,QAEEtG,YAFF;uBACImE;MAAIC,6BAAO;MAAOnE,iBAAAA;MAAaQ;;+BAQ7Bb,uBAAuB;MAJzBkF,wCAAAA;MACAH,iCAAAA;MACAC,kCAAAA;MACAC,8BAAAA;;AAGF,SACEtC,mBAAA,CAAC6B,IAAD;AACEmC,IAAAA,MAAM,EAAE,CAAC1B;AACT2B,IAAAA,IAAI,EAAC;uBACY5B;KACbnE;AACJoC,IAAAA,GAAG,EAAE7C;kCACsB;KACvB8E;AACJ7D,IAAAA,EAAE,EAAE0D;AACJU,IAAAA,QAAQ,EAAE,CAAC;IATb,EAWGpF,QAXH,CADF;AAeD,CA3B2C;;AA0C9C,2CAAa;AACXqG,EAAAA,cAAc,CAACxD,WAAf,GAA6B,gBAA7B;AACAwD,EAAAA,cAAc,CAACvD,SAAf,GAA2B;AACzB9C,IAAAA,QAAQ,EAAE+C,SAAS,CAACC;AADK,GAA3B;AAGD;;;;"}